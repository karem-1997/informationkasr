<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ù‚ØµØ± Ø§Ù„Ø¹ÙŠÙ†ÙŠ Ø§Ù„ÙØ±Ù†Ø³Ø§ÙˆÙŠ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #1a5276; --secondary: #2980b9; --success: #27ae60; --danger: #c0392b; --accent: #f39c12; --bg: #d5d8dc; }
        body { font-family: 'Tajawal', sans-serif; background-color: var(--bg); margin: 0; padding: 10px; padding-bottom: 90px; direction: rtl; }
        .container { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); min-height: 85vh; }
        
        header { text-align: center; margin-bottom: 20px; border-bottom: 3px solid var(--secondary); padding-bottom: 10px; }
        h1 { color: var(--primary); font-size: 1.3rem; margin: 0; }

        /* Ø£ÙŠÙ‚ÙˆÙ†Ø© ÙÙŠØ³Ø¨ÙˆÙƒ Ø§Ù„Ø¹Ø§Ø¦Ù…Ø© */
        .fb-float { position: fixed; bottom: 85px; left: 20px; background: #1877f2; color: white; width: 55px; height: 55px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.6rem; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 1000; text-decoration: none; border: 2px solid #fff; }

        /* Ù„ÙˆØ­Ø§Øª Ø§Ù„ØªØ­ÙƒÙ… */
        .admin-panel { display: none; background: #e8f6f3; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 2px dashed var(--success); }
        input { padding: 12px; border: 1px solid #ccc; border-radius: 8px; font-family: 'Tajawal'; width: 100%; box-sizing: border-box; margin-bottom: 10px; font-size: 1rem; }
        
        /* Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± */
        .list-menu { display: flex; flex-direction: column; gap: 12px; }
        .item-link { position: relative; background: var(--secondary); color: white; padding: 18px; text-align: center; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 1.1rem; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        
        .btn-del-item { position: absolute; top: -5px; left: -5px; background: white; color: red; border: 2px solid red; border-radius: 50%; width: 28px; height: 28px; cursor: pointer; display: none; font-weight: bold; z-index: 20; }

        /* ÙƒØ±ÙˆØª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª */
        .data-card { background: #fff; border: 1px solid #ddd; border-radius: 12px; padding: 15px; margin-bottom: 15px; border-right: 6px solid var(--accent); position: relative; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .data-row { display: flex; flex-direction: column; gap: 4px; margin-bottom: 10px; }
        .data-label { font-size: 0.8rem; color: #7f8c8d; font-weight: bold; }
        .data-value { font-size: 1.05rem; color: var(--primary); font-weight: bold; }
        .badge-price { display: inline-block; background: #eafaf1; color: var(--success); padding: 6px 15px; border-radius: 20px; font-weight: bold; border: 1px solid var(--success); margin: 5px 0; }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙˆØ§ØµÙ„ */
        .contact-box { display: flex; gap: 10px; margin-top: 12px; }
        .c-btn { flex: 1; text-align: center; padding: 12px; border-radius: 8px; text-decoration: none; color: white; font-weight: bold; font-size: 0.85rem; display: flex; align-items: center; justify-content: center; gap: 6px; }
        .wa-btn { background: #25d366; } .fb-btn { background: #1877f2; }

        /* Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø§Ù„Ø³ÙÙ„ÙŠ */
        .footer-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: #fff; padding: 12px; border-top: 2px solid #ddd; display: flex; justify-content: center; z-index: 999; }
        .btn-back-main { background: var(--primary); color: white; width: 90%; max-width: 460px; padding: 14px; border-radius: 10px; text-align: center; font-weight: bold; cursor: pointer; border: none; font-size: 1rem; }

        .btn-admin-login { background: transparent; color: #aaa; margin-top: 40px; font-size: 0.75rem; width: 100%; border: none; text-decoration: underline; cursor: pointer; }

        .screen { display: none; } .active { display: block; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ù‚ØµØ± Ø§Ù„Ø¹ÙŠÙ†ÙŠ Ø§Ù„ÙØ±Ù†Ø³Ø§ÙˆÙŠ</h1>
    </header>

    <a id="h-fb-link" href="#" target="_blank" class="fb-float"><i class="fab fa-facebook-f"></i></a>

    <div id="screen-main" class="screen active">
        <div id="panel-main" class="admin-panel">
            <input type="text" id="h-fb-input" placeholder="Ø±Ø§Ø¨Ø· ÙÙŠØ³Ø¨ÙˆÙƒ Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø¹Ø§Ù…">
            <input type="text" id="new-cat-name" placeholder="Ø¥Ø¶Ø§ÙØ© ØªØµÙ†ÙŠÙ Ø¬Ø¯ÙŠØ¯">
            <button onclick="saveMainSettings()" style="background:var(--success); color:white; width:100%; padding:10px; border-radius:8px;">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
        </div>
        <div class="list-menu" id="cats-list"></div>
        <button class="btn-admin-login" onclick="unlockAdmin()">âš™ï¸ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
    </div>

    <div id="screen-depts" class="screen">
        <h2 id="cat-title" style="text-align:center; color:var(--secondary);"></h2>
        <div id="panel-depts" class="admin-panel">
            <input type="text" id="dept-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯">
            <input type="text" id="dept-wa" placeholder="Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù‚Ø³Ù…">
            <input type="text" id="dept-fb" placeholder="Ø±Ø§Ø¨Ø· ÙÙŠØ³Ø¨ÙˆÙƒ Ø§Ù„Ù‚Ø³Ù…">
            <button onclick="addDept()" style="background:var(--success); color:white; width:100%; padding:10px; border-radius:8px;">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø³Ù…</button>
        </div>
        <div class="list-menu" id="depts-list"></div>
    </div>

    <div id="screen-options" class="screen">
        <h2 id="opt-dept-title" style="text-align:center;"></h2>
        <div id="dept-contact-btns" class="contact-box"></div>
        <div class="list-menu" style="margin-top:25px;">
            <div class="item-link" onclick="showScreen('screen-days')">ğŸ“… Ø¬Ø¯ÙˆÙ„ Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø¯ÙƒØ§ØªØ±Ø©</div>
            <div class="item-link" style="background:var(--accent)" onclick="openServices()">ğŸ’° Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±</div>
        </div>
    </div>

    <div id="screen-days" class="screen">
        <h3 style="text-align:center;">Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ… Ù„Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯</h3>
        <div class="list-menu" id="days-list"></div>
    </div>

    <div id="screen-clinics" class="screen">
        <h3 id="clinic-day-title" style="text-align:center; color:var(--accent);"></h3>
        <div id="panel-clinics" class="admin-panel">
            <input type="text" id="c-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©">
            <input type="text" id="c-doc" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¯ÙƒØªÙˆØ±">
            <input type="text" id="c-time" placeholder="Ø§Ù„Ù…ÙˆØ¹Ø¯ (Ù…Ø«Ù„Ø§Ù‹: 12 - 4 Ø¸)">
            <input type="number" id="c-price" placeholder="Ø³Ø¹Ø± Ø§Ù„ÙƒØ´Ù">
            <input type="text" id="c-wa" placeholder="ÙˆØ§ØªØ³Ø§Ø¨ Ø®Ø§Øµ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
            <button onclick="saveClinic()" style="background:var(--success); color:white; width:100%; padding:10px; border-radius:8px;">Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
        </div>
        <div id="clinics-list"></div>
    </div>

    <div id="screen-services" class="screen">
        <h3 style="text-align:center;">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±</h3>
        <div id="panel-services" class="admin-panel">
            <input type="text" id="s-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø©">
            <input type="number" id="s-price" placeholder="Ø§Ù„Ø³Ø¹Ø±">
            <button onclick="addService()" style="background:var(--success); color:white; width:100%; padding:10px; border-radius:8px;">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®Ø¯Ù…Ø©</button>
        </div>
        <div id="services-list"></div>
    </div>

    <div class="footer-nav" id="master-footer" style="display:none;">
        <button class="btn-back-main" id="back-btn">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</button>
    </div>
</div>

<script>
    // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    const KEY = "All";
    const DAYS = ["Ø§Ù„Ø³Ø¨Øª", "Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡", "Ø§Ù„Ø®Ù…ÙŠØ³", "Ø§Ù„Ø¬Ù…Ø¹Ø©"];
    
    // Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø±
    let state = JSON.parse(localStorage.getItem('FR_DB_FINAL')) || {
        fb: "#",
        cats: []
    };
    
    let cur = { cat: null, dept: null, day: null, editIdx: -1 };
    let isAdmin = false;

    function saveAll() { localStorage.setItem('FR_DB_FINAL', JSON.stringify(state)); }

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        
        const footer = document.getElementById('master-footer');
        const back = document.getElementById('back-btn');
        
        if (id === 'screen-main') {
            footer.style.display = 'none';
        } else {
            footer.style.display = 'flex';
            if(id === 'screen-depts') back.onclick = () => showScreen('screen-main');
            if(id === 'screen-options') back.onclick = () => showScreen('screen-depts');
            if(id === 'screen-days') back.onclick = () => showScreen('screen-options');
            if(id === 'screen-clinics') back.onclick = () => showScreen('screen-days');
            if(id === 'screen-services') back.onclick = () => showScreen('screen-options');
        }
        window.scrollTo(0,0);
    }

    function unlockAdmin() {
        if (prompt("Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± (All):") === KEY) {
            isAdmin = true;
            document.querySelectorAll('.admin-panel').forEach(p => p.style.display = 'block');
            document.querySelectorAll('.btn-del-item').forEach(b => b.style.display = 'block');
            renderAll();
            alert("ØªÙ… ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¨Ù†Ø¬Ø§Ø­");
        }
    }

    // --- Ù†Ø¸Ø§Ù… Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª ---
    function saveMainSettings() {
        state.fb = document.getElementById('h-fb-input').value || state.fb;
        let name = document.getElementById('new-cat-name').value;
        if(name) {
            state.cats.push({ name: name, depts: [] });
            document.getElementById('new-cat-name').value = "";
        }
        saveAll(); renderAll();
    }

    function renderAll() {
        renderCats();
        document.getElementById('h-fb-link').href = state.fb;
    }

    function renderCats() {
        const div = document.getElementById('cats-list'); div.innerHTML = "";
        state.cats.forEach((c, i) => {
            div.innerHTML += `<div class="item-link">
                <span onclick="goToDepts(${i})">${c.name}</span>
                <button class="btn-del-item" onclick="delCat(${i})" style="display:${isAdmin?'block':'none'}">X</button>
            </div>`;
        });
    }
    function delCat(i) { if(confirm("Ø­Ø°Ù Ø§Ù„ØªØµÙ†ÙŠÙØŸ")){ state.cats.splice(i,1); saveAll(); renderCats(); } }
    function goToDepts(i) {
        cur.cat = state.cats[i];
        document.getElementById('cat-title').innerText = cur.cat.name;
        renderDepts();
        showScreen('screen-depts');
    }

    // --- Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ---
    function addDept() {
        let n = document.getElementById('dept-name').value;
        if(n) {
            cur.cat.depts.push({
                name: n,
                wa: document.getElementById('dept-wa').value,
                fb: document.getElementById('dept-fb').value,
                clinics: {},
                services: []
            });
            saveAll(); renderDepts();
            document.querySelectorAll('#panel-depts input').forEach(i=>i.value="");
        }
    }
    function renderDepts() {
        const div = document.getElementById('depts-list'); div.innerHTML = "";
        cur.cat.depts.forEach((d, i) => {
            div.innerHTML += `<div class="item-link">
                <span onclick="goToOptions(${i})">${d.name}</span>
                <button class="btn-del-item" onclick="delDept(${i})" style="display:${isAdmin?'block':'none'}">X</button>
            </div>`;
        });
    }
    function delDept(i) { cur.cat.depts.splice(i,1); saveAll(); renderDepts(); }
    function goToOptions(i) {
        cur.dept = cur.cat.depts[i];
        document.getElementById('opt-dept-title').innerText = cur.dept.name;
        let soc = document.getElementById('dept-contact-btns'); soc.innerHTML = "";
        if(cur.dept.wa) soc.innerHTML += `<a href="https://wa.me/${cur.dept.wa}" class="c-btn wa-btn"><i class="fab fa-whatsapp"></i> ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù‚Ø³Ù…</a>`;
        if(cur.dept.fb) soc.innerHTML += `<a href="${cur.dept.fb}" class="c-btn fb-btn"><i class="fab fa-facebook-f"></i> ÙÙŠØ³Ø¨ÙˆÙƒ Ø§Ù„Ù‚Ø³Ù…</a>`;
        showScreen('screen-options');
    }

    // --- Ù†Ø¸Ø§Ù… Ø§Ù„Ø£ÙŠØ§Ù… ÙˆØ§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ ---
    function renderDays() {
        const div = document.getElementById('days-list'); div.innerHTML = "";
        DAYS.forEach(day => {
            div.innerHTML += `<div class="item-link" style="background:#5d6d7e" onclick="goToClinics('${day}')">${day}</div>`;
        });
    }
    function goToClinics(day) {
        cur.day = day;
        document.getElementById('clinic-day-title').innerText = cur.dept.name + " - ÙŠÙˆÙ… " + day;
        renderClinics();
        showScreen('screen-clinics');
    }
    function saveClinic() {
        if(!cur.dept.clinics[cur.day]) cur.dept.clinics[cur.day] = [];
        let obj = {
            name: document.getElementById('c-name').value,
            doc: document.getElementById('c-doc').value,
            time: document.getElementById('c-time').value,
            price: document.getElementById('c-price').value,
            wa: document.getElementById('c-wa').value
        };
        if(cur.editIdx === -1) cur.dept.clinics[cur.day].push(obj);
        else { cur.dept.clinics[cur.day][cur.editIdx] = obj; cur.editIdx = -1; }
        saveAll(); renderClinics();
        document.querySelectorAll('#panel-clinics input').forEach(i=>i.value="");
    }
    function renderClinics() {
        const div = document.getElementById('clinics-list'); div.innerHTML = "";
        let list = cur.dept.clinics[cur.day] || [];
        list.forEach((c, i) => {
            div.innerHTML += `
            <div class="data-card">
                <div class="data-row"><span class="data-label">Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©:</span><span class="data-value">${c.name}</span></div>
                <div class="data-row"><span class="data-label">Ø§Ù„Ø¯ÙƒØªÙˆØ±:</span><span class="data-value">Ø¯. ${c.doc}</span></div>
                <div class="data-row"><span class="data-label">Ø§Ù„Ù…ÙˆØ¹Ø¯:</span><span class="data-value">${c.time}</span></div>
                <div class="badge-price">${c.price} Ø¬.Ù…</div>
                ${c.wa ? `<a href="https://wa.me/${c.wa}" class="c-btn wa-btn" style="margin-top:5px;"><i class="fab fa-whatsapp"></i> ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©</a>` : ''}
                <div style="display:${isAdmin?'flex':'none'}; gap:10px; margin-top:10px;">
                    <button onclick="editC(${i})" style="flex:1; background:orange; color:white; border-radius:5px; border:none; padding:8px;">ØªØ¹Ø¯ÙŠÙ„</button>
                    <button onclick="delC(${i})" style="flex:1; background:red; color:white; border-radius:5px; border:none; padding:8px;">Ø­Ø°Ù</button>
                </div>
            </div>`;
        });
    }
    function delC(i) { cur.dept.clinics[cur.day].splice(i,1); saveAll(); renderClinics(); }
    function editC(i) {
        let c = cur.dept.clinics[cur.day][i];
        document.getElementById('c-name').value=c.name; document.getElementById('c-doc').value=c.doc;
        document.getElementById('c-time').value=c.time; document.getElementById('c-price').value=c.price;
        document.getElementById('c-wa').value=c.wa; cur.editIdx = i; window.scrollTo(0,0);
    }

    // --- Ù†Ø¸Ø§Ù… Ø§Ù„Ø®Ø¯Ù…Ø§Øª ---
    function openServices() { renderServices(); showScreen('screen-services'); }
    function addService() {
        let n = document.getElementById('s-name').value;
        let p = document.getElementById('s-price').value;
        if(n && p) {
            cur.dept.services.push({ name: n, price: p });
            saveAll(); renderServices();
            document.getElementById('s-name').value=""; document.getElementById('s-price').value="";
        }
    }
    function renderServices() {
        const div = document.getElementById('services-list'); div.innerHTML = "";
        cur.dept.services.forEach((s, i) => {
            div.innerHTML += `
            <div class="data-card">
                <div class="data-row"><span class="data-label">Ø§Ù„Ø®Ø¯Ù…Ø©:</span><span class="data-value">${s.name}</span></div>
                <div class="badge-price">${s.price} Ø¬.Ù…</div>
                <button class="btn-del-item" onclick="delS(${i})" style="display:${isAdmin?'block':'none'}">X</button>
            </div>`;
        });
    }
    function delS(i) { cur.dept.services.splice(i,1); saveAll(); renderServices(); }

    // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    renderAll();
    renderDays();
</script>
</body>
</html>

